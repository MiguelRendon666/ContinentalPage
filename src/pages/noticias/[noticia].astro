---
import { NoticiaFetch } from '../../fetch/noticia-fetch';
import BaseLayout from '../../layouts/BaseLayout.astro';
import type { Noticia as NoticiaType } from '../../models/noticia';

export async function getStaticPaths() {
  const noticiasResponse = await NoticiaFetch.getAll();
  const noticias: NoticiaType[] = 'error' in noticiasResponse ? [] : noticiasResponse as NoticiaType[];
  return noticias.map((noticia) => ({
    params: { noticia: noticia.url_busqueda },
  }));
}

const { noticia } = Astro.params;
const noticiaResponse = await NoticiaFetch.getByUrl(noticia);
const noticiaData: NoticiaType | null = 'error' in noticiaResponse ? null : noticiaResponse as NoticiaType;
--- 

<BaseLayout>
    <div slot="header-slot" class="news-page-header">
		<h1>{noticiaData ? noticiaData.titulo : 'Noticia no encontrada'}</h1>
	</div>

    <div class="news-page-content">
        <div class="news-page-data">
            <h3>{noticiaData ? noticiaData.descripcion_corta : ''}</h3>
            <hr>
            <div class="news-page-image-container">
                <img src={noticiaData ? noticiaData.url_portada : ''} alt={noticiaData ? noticiaData.titulo : ''}>
            </div>
            <hr>
            <p>{noticiaData ? noticiaData.texto_noticia : ''}</p>
        </div>
    </div>
</BaseLayout>

<style>
	.news-page-header {
		height: 300px;
		display: flex;
		padding-block: 1rem;
		padding-inline: 2rem;
		flex-direction: column-reverse;
		font-size: 2rem;
	}

    .news-page-content {
        max-width: 1000px;
        margin: 0 auto;
        padding: 24px 16px;
    }

    .news-page-data {
        width: 100%;
        height: fit-content;
        padding: 2rem;
        background-color: var(--color-bg-obsidian);
        border-radius: 2rem;
    }

    .news-page-image-container {
        width: 100%;
        height: auto;
        margin-top: 1rem;
        display: flex;
        justify-content: center;
    }
</style>